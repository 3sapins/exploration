<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rencontre des civilisations : Cortés & Moctezuma</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <header class="app-header">
    <h1>Rencontre des civilisations : <span class="accent">Cortés</span> & <span class="accent">Moctezuma</span></h1>
    <p class="subtitle">Aventure interactive à choix multiples — perspective croisée Espagne / Aztèques</p>
    <nav class="top-actions">
      <button id="btn-sources" class="link">Sources & lecture</button>
      <button id="btn-glossary" class="link">Glossaire</button>
      <button id="btn-reset" class="link">Recommencer</button>
    </nav>
  </header>

  <main id="game">
    <section id="character-select" class="panel">
      <h2>Choisissez votre parcours</h2>
      <div class="char-grid">
        <button class="char-card" data-char="cortes">
          <div class="scene" id="scene-cortes"></div>
          <h3>Hernán Cortés</h3>
          <p>Ambitions, alliances, stratégies et dilemmes — jusqu'à la Noche Triste et la conquête.</p>
        </button>
        <button class="char-card" data-char="moctezuma">
          <div class="scene" id="scene-moctezuma"></div>
          <h3>Moctezuma II</h3>
          <p>Règne, traditions, présages, débats, accueil des étrangers et défense de Tenochtitlán.</p>
        </button>
      </div>
    </section>

    <section id="hud" class="hud hidden">
      <div class="stats" id="stats"></div>
      <div class="progress-info">
        <span id="chapter-title"></span>
        <span id="turn-count"></span>
      </div>
    </section>

    <section id="story" class="panel hidden">
      <div class="art" id="art"></div>
      <div id="narrative"></div>
      <div id="choices" class="choices"></div>
      <div id="teacher-note" class="teacher-note hidden"></div>
    </section>

    <section id="endings" class="panel hidden"></section>
  </main>

  <footer class="app-footer">
    <p>Charte visuelle historique : conquistadors (parcours Cortés) et codex (parcours Moctezuma). © 2026</p>
  </footer>

  <dialog id="dlg-sources" class="modal">
    <h3>Sources & lectures recommandées</h3>
    <ul class="sources-list">
      <li>Bernal Díaz del Castillo, <em>Histoire véritable de la conquête de la Nouvelle-Espagne</em>.</li>
      <li>Hernán Cortés, <em>Lettres de relation</em>.</li>
      <li>Fray Bernardino de Sahagún, <em>Codex florentin</em> (Livre 12).</li>
      <li>James Lockhart, <em>We People Here: Nahuatl Accounts of the Conquest of Mexico</em>.</li>
      <li>Matthew Restall, <em>Seven Myths of the Spanish Conquest</em>.</li>
    </ul>
    <button id="close-sources">Fermer</button>
  </dialog>

  <dialog id="dlg-glossary" class="modal">
    <h3>Glossaire rapide</h3>
    <ul>
      <li><strong>Brigantins</strong> : petits navires assemblés pour contrôler les lacs autour de Tenochtitlán.</li>
      <li><strong>Noche Triste</strong> : nuit de la retraite espagnole (juin 1520), lourdes pertes.</li>
      <li><strong>Calpulli</strong> : communauté de base au sein de la société mexica (aztèque).</li>
      <li><strong>Tribut</strong> : ressources versées par les provinces à l'empire mexica.</li>
      <li><strong>Tlaxcala</strong> : adversaire des Mexicas devenu allié de Cortés.</li>
    </ul>
    <button id="close-glossary">Fermer</button>
  </dialog>

  <script src="assets/game.js"></script>

  <dialog id="dlg-credits" class="modal">
    <h3>Crédits images</h3>
    <p>Images du <strong>Codex florentin</strong> (Biblioteca Medicea Laurenziana, édition numérique par le <strong>Getty Research Institute</strong>), et ressources Wikimedia Commons, utilisées à des fins pédagogiques.</p>
    <ul>
      <li>Florentine Codex — Édition numérique : Getty Research Institute (Livre 12, Tóxcatl, rencontres, etc.).</li>
      <li>Wikimedia Commons — Catégorie “Florentine Codex”.</li>
      <li>Early Nahuatl Library — Folios sélectionnés (Livre 12).</li>
    </ul>
    <button id="close-credits">Fermer</button>
  </dialog>
  <script>
    // Wire credits modal button dynamically
    const hdr = document.querySelector('.top-actions');
    if (hdr) {
      const b = document.createElement('button'); b.className='link'; b.id='btn-credits'; b.textContent='Crédits images';
      hdr.appendChild(b);
      const dlg = document.getElementById('dlg-credits');
      document.getElementById('btn-credits').addEventListener('click', ()=> dlg.showModal());
      document.getElementById('close-credits').addEventListener('click', ()=> dlg.close());
    }
  </script>
</body>
</html>
